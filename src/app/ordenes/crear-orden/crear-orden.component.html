<!-- src/app/pages/crear-orden/crear-orden.component.html -->

<form [formGroup]="ordenForm" (ngSubmit)="submit()" class="orden-form mat-elevation-z4">
  <h2>Crear Orden de Trabajo</h2>

  <div class="form-grid">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Tipo de Orden</mat-label>
      <mat-select formControlName="tipoDeOrden" (selectionChange)="onTipoOrdenChange()">
        <mat-option value="">Seleccione tipo</mat-option>
        <mat-option value="limpieza">Limpieza</mat-option>
        <mat-option value="trasiego">Trasiego</mat-option>
        <mat-option value="clarificacion">Clarificación</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Prioridad</mat-label>
      <mat-select formControlName="prioridad" required>
        <mat-option *ngFor="let p of prioridades" [value]="p">{{ p }}</mat-option>
      </mat-select>
    </mat-form-field>
    
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Fecha de realización</mat-label>
      <input matInput [matDatepicker]="picker" formControlName="fecha_de_realizacion" placeholder="Seleccione una fecha" required>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>
    
  </div>
  <div formGroupName="camposTipoOrden" *ngIf="ordenForm.get('camposTipoOrden')">
    <div *ngIf="tipoSeleccionado === 'limpieza'" class="form-grid">
      <h2>Campos de Tipo de Orden</h2>
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Depósito</mat-label>
        <input matInput formControlName="deposito" placeholder="Ej: D-102">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Tipo de limpieza</mat-label>
        <input matInput formControlName="tipo_de_limpieza" placeholder="Ej: CIP">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Observaciones</mat-label>
        <textarea matInput formControlName="observaciones" placeholder="Opcional"></textarea>
      </mat-form-field>
    </div>

    <div *ngIf="tipoSeleccionado === 'trasiego'" class="form-grid">
      <h2>Campos de Tipo de Orden</h2>
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Producto</mat-label>
        <input matInput formControlName="producto" placeholder="Ej: Vino blanco">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Depósito origen</mat-label>
        <input matInput formControlName="deposito_origen" placeholder="Ej: D-101">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Depósito destino</mat-label>
        <input matInput formControlName="deposito_destino" placeholder="Ej: D-102">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Cantidad a trasegar</mat-label>
        <input matInput formControlName="cantidad_a_trasegar" placeholder="Ej: 2000 L">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Tipo de limpieza</mat-label>
        <input matInput formControlName="tipo_de_limpieza" placeholder="Ej: Manual">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Observaciones</mat-label>
        <textarea matInput formControlName="observaciones" placeholder="Opcional"></textarea>
      </mat-form-field>
    </div>

    <div *ngIf="tipoSeleccionado === 'clarificacion'" class="form-grid">
      <h2>Campos de Tipo de Orden</h2>
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Producto</mat-label>
        <input matInput formControlName="producto" placeholder="Ej: Mosto">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Depósito</mat-label>
        <input matInput formControlName="deposito" placeholder="Ej: D-103">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Coadyuvantes extra</mat-label>
        <input matInput formControlName="coadyuvantes_extra" placeholder="Ej: Gelatina">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Observaciones</mat-label>
        <textarea matInput formControlName="observaciones" placeholder="Opcional"></textarea>
      </mat-form-field>
    </div>
  </div>

  <button mat-raised-button color="primary" type="submit">Crear orden</button>
</form>
